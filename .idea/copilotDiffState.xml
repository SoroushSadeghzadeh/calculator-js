<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/index.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/index.html" />
              <option name="originalContent" value="&lt;!doctype html&gt;&#10;&lt;html lang=&quot;fa&quot; dir=&quot;rtl&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;utf-8&quot;/&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;/&gt;&#10;    &lt;title&gt;ماشین‌حساب — UI&lt;/title&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&#10;&lt;main class=&quot;calculator&quot; role=&quot;main&quot; aria-label=&quot;ماشین‌حساب&quot;&gt;&#10;&#10;    &lt;!-- Header --&gt;&#10;    &lt;div class=&quot;calculator__top&quot;&gt;&#10;        &lt;div class=&quot;brand&quot;&gt;&#10;            &lt;span class=&quot;brand__dot&quot;&gt;&lt;/span&gt;&#10;            &lt;div class=&quot;brand__title&quot;&gt;ماشین‌حساب&lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;subtle&quot;&gt;v1&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Display --&gt;&#10;    &lt;section class=&quot;display&quot; aria-live=&quot;polite&quot;&gt;&#10;        &lt;div id=&quot;memory&quot; class=&quot;display__mem&quot;&gt;&amp;nbsp;&lt;/div&gt;&#10;        &lt;div id=&quot;display&quot; class=&quot;display__value&quot;&gt;0&lt;/div&gt;&#10;    &lt;/section&gt;&#10;&#10;    &lt;!-- Keys --&gt;&#10;    &lt;div class=&quot;keys&quot;&gt;&#10;&#10;        &lt;!-- Row 1 --&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;clear&quot;&gt;AC&lt;/button&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;neg&quot;&gt;±&lt;/button&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;percent&quot;&gt;%&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;/&quot;&gt;÷&lt;/button&gt;&#10;&#10;        &lt;!-- Row 2 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;7&quot;&gt;7&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;8&quot;&gt;8&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;9&quot;&gt;9&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;*&quot;&gt;×&lt;/button&gt;&#10;&#10;        &lt;!-- Row 3 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;4&quot;&gt;4&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;5&quot;&gt;5&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;6&quot;&gt;6&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;-&quot;&gt;−&lt;/button&gt;&#10;&#10;        &lt;!-- Row 4 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;1&quot;&gt;1&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;2&quot;&gt;2&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;3&quot;&gt;3&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;+&quot;&gt;+&lt;/button&gt;&#10;&#10;        &lt;!-- Row 5 --&gt;&#10;        &lt;button class=&quot;key key--number key--wide&quot; data-digit=&quot;0&quot;&gt;0&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;.&quot;&gt;.&lt;/button&gt;&#10;        &lt;button class=&quot;key key--equal&quot; data-action=&quot;=&quot;&gt;=&lt;/button&gt;&#10;&#10;    &lt;/div&gt;&#10;&#10;&lt;/main&gt;&#10;&#10;&lt;script type=&quot;module&quot; src=&quot;src/index.js&quot;&gt;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;" />
              <option name="updatedContent" value="&lt;!doctype html&gt;&#10;&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;&#10;&lt;head&gt;&#10;    &lt;meta charset=&quot;utf-8&quot;/&gt;&#10;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;/&gt;&#10;    &lt;title&gt;Calculator — UI&lt;/title&gt;&#10;    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;&#10;&lt;/head&gt;&#10;&lt;body&gt;&#10;&#10;&lt;main class=&quot;calculator&quot; role=&quot;main&quot; aria-label=&quot;Calculator&quot;&gt;&#10;&#10;    &lt;!-- Header --&gt;&#10;    &lt;div class=&quot;calculator__top&quot;&gt;&#10;        &lt;div class=&quot;brand&quot;&gt;&#10;            &lt;span class=&quot;brand__dot&quot;&gt;&lt;/span&gt;&#10;            &lt;div class=&quot;brand__title&quot;&gt;Calculator&lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;subtle&quot;&gt;v1&lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- Display --&gt;&#10;    &lt;section class=&quot;display&quot; aria-live=&quot;polite&quot;&gt;&#10;        &lt;div id=&quot;memory&quot; class=&quot;display__mem&quot;&gt;&amp;nbsp;&lt;/div&gt;&#10;        &lt;div id=&quot;display&quot; class=&quot;display__value&quot;&gt;0&lt;/div&gt;&#10;    &lt;/section&gt;&#10;&#10;    &lt;!-- Keys --&gt;&#10;    &lt;div class=&quot;keys&quot;&gt;&#10;&#10;        &lt;!-- Row 1 --&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;clear&quot;&gt;AC&lt;/button&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;neg&quot;&gt;±&lt;/button&gt;&#10;        &lt;button class=&quot;key key--action&quot; data-action=&quot;percent&quot;&gt;%&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;/&quot;&gt;÷&lt;/button&gt;&#10;&#10;        &lt;!-- Row 2 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;7&quot;&gt;7&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;8&quot;&gt;8&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;9&quot;&gt;9&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;*&quot;&gt;×&lt;/button&gt;&#10;&#10;        &lt;!-- Row 3 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;4&quot;&gt;4&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;5&quot;&gt;5&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;6&quot;&gt;6&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;-&quot;&gt;−&lt;/button&gt;&#10;&#10;        &lt;!-- Row 4 --&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;1&quot;&gt;1&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;2&quot;&gt;2&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;3&quot;&gt;3&lt;/button&gt;&#10;        &lt;button class=&quot;key key--operator&quot; data-action=&quot;+&quot;&gt;+&lt;/button&gt;&#10;&#10;        &lt;!-- Row 5 --&gt;&#10;        &lt;button class=&quot;key key--number key--wide&quot; data-digit=&quot;0&quot;&gt;0&lt;/button&gt;&#10;        &lt;button class=&quot;key key--number&quot; data-digit=&quot;.&quot;&gt;.&lt;/button&gt;&#10;        &lt;button class=&quot;key key--equal&quot; data-action=&quot;=&quot;&gt;=&lt;/button&gt;&#10;&#10;    &lt;/div&gt;&#10;&#10;&lt;/main&gt;&#10;&#10;&lt;script type=&quot;module&quot; src=&quot;src/index.js&quot;&gt;&lt;/script&gt;&#10;&#10;&lt;/body&gt;&#10;&lt;/html&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/Calculator.js">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/Calculator.js" />
              <option name="originalContent" value="export default class Calculator {&#10;    constructor() {&#10;        this.reset();&#10;    }&#10;&#10;    reset() {&#10;        this.expression = [];&#10;        this.current = &quot;0&quot;;&#10;        this.resultShown = false;&#10;                this.memory = &quot;&quot;&#10;    }&#10;&#10;    appendDigit(digit) {&#10;        if (this.resultShown) {&#10;            this.expression = [];&#10;            this.current = &quot;0&quot;;&#10;            this.resultShown = false;&#10;        }&#10;        if (this.current === &quot;0&quot; &amp;&amp; digit !== &quot;.&quot;) {&#10;            this.current = digit;&#10;        } else if (digit === &quot;.&quot; &amp;&amp; this.current.includes(&quot;.&quot;)) {&#10;            return;&#10;        } else {&#10;            this.current += digit;&#10;        }&#10;    }&#10;&#10;    appendOperator(operator) {&#10;        if (this.resultShown) {&#10;            this.expression = [this.current];&#10;            this.resultShown = false;&#10;        } else {&#10;            this.expression.push(this.current);&#10;        }&#10;&#10;        const last = this.expression[this.expression.length - 1];&#10;        if ([&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;].includes(last)) {&#10;            this.expression[this.expression.length - 1] = operator;&#10;        } else {&#10;            this.expression.push(operator);&#10;        }&#10;&#10;        this.current = &quot;0&quot;;&#10;    }&#10;&#10;    toggleSign() {&#10;        const num = parseFloat(this.current);&#10;        if (!isNaN(num)) {&#10;            this.current = (num * -1).toString();&#10;        }&#10;    }&#10;&#10;    percent() {&#10;        const num = parseFloat(this.current);&#10;        if (!isNaN(num)) {&#10;            this.current = (num / 100).toString();&#10;        }&#10;    }&#10;&#10;    calculate() {&#10;        if (this.expression.length === 0) return;&#10;&#10;        this.expression.push(this.current);&#10;&#10;        this.memory = this.expression.join(&quot; &quot;);&#10;&#10;        try {&#10;            const outputQueue = [];&#10;            const operatorStack = [];&#10;            const precedence = {&quot;+&quot;: 1, &quot;-&quot;: 1, &quot;*&quot;: 2, &quot;/&quot;: 2};&#10;&#10;            for (const token of this.expression) {&#10;                if (!isNaN(token)) {&#10;                    outputQueue.push(parseFloat(token));&#10;                } else if (precedence[token]) {&#10;                    while (&#10;                        operatorStack.length &amp;&amp;&#10;                        precedence[operatorStack.at(-1)] &gt;= precedence[token]&#10;                        ) {&#10;                        outputQueue.push(operatorStack.pop());&#10;                    }&#10;                    operatorStack.push(token);&#10;                }&#10;            }&#10;&#10;            while (operatorStack.length) {&#10;                outputQueue.push(operatorStack.pop());&#10;            }&#10;&#10;            const stack = [];&#10;            for (const token of outputQueue) {&#10;                if (typeof token === &quot;number&quot;) {&#10;                    stack.push(token);&#10;                } else {&#10;                    const b = stack.pop();&#10;                    const a = stack.pop();&#10;                    if (a === undefined || b === undefined) {&#10;                        throw new Error(&quot;Invalid expression&quot;);&#10;                    }&#10;                    if (token === &quot;/&quot; &amp;&amp; b === 0) throw new Error(&quot;Error&quot;);&#10;&#10;                                        const result = eval(`${a} ${token} ${b}`);&#10;                    stack.push(result);&#10;                }&#10;            }&#10;&#10;            this.current = stack[0].toString();&#10;            this.expression = [];&#10;            this.resultShown = true;&#10;&#10;        } catch (err) {&#10;            this.current = &quot;Error&quot;;&#10;            this.expression = [];&#10;            this.resultShown = true;&#10;        }&#10;    }&#10;&#10;    getMainDisplay() {&#10;        if (this.resultShown) return this.current;&#10;        return [...this.expression, this.current].join(&quot; &quot;);&#10;    }&#10;&#10;    getMemoryDisplay() {&#10;        return this.memory;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="export default class Calculator {&#10;    constructor() {&#10;        this.reset();&#10;    }&#10;&#10;    reset() {&#10;        this.expression = [];&#10;        this.current = &quot;0&quot;;&#10;        this.resultShown = false;&#10;    }&#10;&#10;    appendDigit(digit) {&#10;        if (this.resultShown) {&#10;            this.reset();&#10;        }&#10;        if (this.current === &quot;0&quot; &amp;&amp; digit !== &quot;.&quot;) {&#10;            this.current = digit;&#10;        } else if (digit === &quot;.&quot; &amp;&amp; this.current.includes(&quot;.&quot;)) {&#10;            // Do nothing if a decimal point is already present&#10;        } else {&#10;            this.current += digit;&#10;        }&#10;    }&#10;&#10;    appendOperator(operator) {&#10;        if (this.resultShown) {&#10;            this.expression = [this.current];&#10;            this.resultShown = false;&#10;        } else if (this.current !== &quot;&quot;) {&#10;            this.expression.push(this.current);&#10;        }&#10;&#10;        const last = this.expression[this.expression.length - 1];&#10;        if ([&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;].includes(last)) {&#10;            this.expression[this.expression.length - 1] = operator;&#10;        } else {&#10;            this.expression.push(operator);&#10;        }&#10;&#10;        this.current = &quot;&quot;;&#10;    }&#10;&#10;    toggleSign() {&#10;        if (this.current === &quot;&quot; || this.current === &quot;0&quot;) return;&#10;        const num = parseFloat(this.current);&#10;        if (!isNaN(num)) {&#10;            this.current = (num * -1).toString();&#10;        }&#10;    }&#10;&#10;    percent() {&#10;        if (this.current === &quot;&quot;) return;&#10;        const num = parseFloat(this.current);&#10;        if (!isNaN(num)) {&#10;            this.current = (num / 100).toString();&#10;        }&#10;    }&#10;&#10;    calculate() {&#10;        if (this.expression.length &lt; 2) return;&#10;&#10;        if (this.current !== &quot;&quot;) {&#10;            this.expression.push(this.current);&#10;        }&#10;&#10;        // Ensure the expression ends with a number&#10;        const lastElement = this.expression[this.expression.length - 1];&#10;        if ([&quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;].includes(lastElement)) {&#10;            this.expression.pop();&#10;        }&#10;&#10;        try {&#10;            // Using a safer evaluation than eval()&#10;            const result = this.evaluateExpression(this.expression);&#10;            this.current = result.toString();&#10;            this.expression = [];&#10;            this.resultShown = true;&#10;&#10;        } catch (err) {&#10;            this.current = &quot;Error&quot;;&#10;            this.expression = [];&#10;            this.resultShown = true;&#10;        }&#10;    }&#10;&#10;    evaluateExpression(expression) {&#10;        // This is a simplified evaluation that respects order of operations (MDAS)&#10;        // It's safer than eval()&#10;        let values = [];&#10;        let ops = [];&#10;&#10;        for (let i = 0; i &lt; expression.length; i++) {&#10;            let token = expression[i];&#10;            if (!isNaN(parseFloat(token)) &amp;&amp; isFinite(token)) {&#10;                values.push(parseFloat(token));&#10;            } else { // operator&#10;                while (ops.length &gt; 0 &amp;&amp; this.hasPrecedence(ops[ops.length - 1], token)) {&#10;                    values.push(this.applyOp(ops.pop(), values.pop(), values.pop()));&#10;                }&#10;                ops.push(token);&#10;            }&#10;        }&#10;&#10;        while (ops.length &gt; 0) {&#10;            values.push(this.applyOp(ops.pop(), values.pop(), values.pop()));&#10;        }&#10;&#10;        const result = values.pop();&#10;        if (result === Infinity || result === -Infinity) {&#10;            throw new Error(&quot;Division by zero&quot;);&#10;        }&#10;        return result;&#10;    }&#10;&#10;    hasPrecedence(op1, op2) {&#10;        return (op1 === '*' || op1 === '/') &amp;&amp; (op2 === '+' || op2 === '-');&#10;    }&#10;&#10;    applyOp(op, b, a) {&#10;        switch (op) {&#10;            case '+': return a + b;&#10;            case '-': return a - b;&#10;            case '*': return a * b;&#10;            case '/':&#10;                if (b === 0) throw new Error(&quot;Division by zero&quot;);&#10;                return a / b;&#10;        }&#10;    }&#10;&#10;&#10;    getMainDisplay() {&#10;        return this.current || &quot;0&quot;;&#10;    }&#10;&#10;    getMemoryDisplay() {&#10;        return this.expression.join(&quot; &quot;);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>